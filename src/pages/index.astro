---
import Sidebar from '../components/Sidebar.astro';
import Header from '../components/Header.astro';
import Search from '../components/Search.astro';
import Footer from '../components/Footer.astro';

import CategorySection from '../components/CategorySection.astro';
import { getCategoryName, getCategoryIcon } from '../data/category';
import { SITE_DESCRIPTION, SITE_TITLE } from '../settings';
// 动态加载分类数据
const categoryFiles = import.meta.glob('../data/sites/*.js');
const categories = Object.keys(categoryFiles).map(path => {
  const fileName = path.split('/').pop(); // 可能是 undefined
  return fileName?.replace('.js', '') ?? ''; // 安全处理
}).filter(Boolean);
const categoryData = await Promise.all(
  categories.map(async (category) => ({
    name: category,
    displayName: getCategoryName(category), 
    icon: getCategoryIcon(category),
    sites: (await import(`../data/sites/${category}.js`)).default
  }))
);
---




<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta name="generator" content="Hugo 0.121.0">
	
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#f9f9f9" />
    <!-- 网站设定 -->
    <title>{SITE_TITLE}</title>
    <link rel="shortcut icon" href="/images/favicon.png" />
    <meta name="keywords" content={SITE_TITLE} />
    <meta name="description" content={SITE_DESCRIPTION} />

    <!-- Preload 关键资源 -->
    <link rel="preload" href="/css/block-library.min-5.6.2.css" as="style">

    <!-- <link rel="stylesheet" id="block-library-css"
        href="/css/block-library.min-5.6.2.css" type="text/css" media="all" /> -->
    <link rel="stylesheet" id="iconfont-css" href="/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="bootstrap-css" href="/css/bootstrap.min-4.3.1.css"
        type="text/css" media="all" />
    <!-- <link rel="stylesheet" id="fancybox-css" href="/css/fancybox.min-3.5.7.css"
        type="text/css" media="all" /> -->
    <link rel="stylesheet" id="iowen-css" href="/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/css/custom-style.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="fortawesome-css" href="/fontawesome-5.15.4/css/all.min.css" type="text/css" />
    
    
    <!-- 脚本控制 -->
    <script type="text/javascript" src="/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script src="/js/content-search.js" defer id="content-search-js"></script>
    

</head>


<body class="io-grey-mode">
<div class="page-container">
<Sidebar />
<div class="main-content flex-fill grid-bg"> 
<Header />
<Search />
<div id="content" class="content-site customize-site">
     {categoryData.map(({ name, displayName, icon, sites }) => (
    <CategorySection 
      category={name}
      displayName={displayName} 
      icon={icon}              
      sites={sites}
    />
  ))}

</div>
     <Footer />
    </div>
</div>

</body>
</html>


